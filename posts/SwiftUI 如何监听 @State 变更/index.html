<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Coder ç°æ¡‘"/><link rel="canonical" href="https://coder.linsyorozuya.com/posts/SwiftUI%20%E5%A6%82%E4%BD%95%E7%9B%91%E5%90%AC%20@State%20%E5%8F%98%E6%9B%B4"/><meta name="twitter:url" content="https://coder.linsyorozuya.com/posts/SwiftUI%20%E5%A6%82%E4%BD%95%E7%9B%91%E5%90%AC%20@State%20%E5%8F%98%E6%9B%B4"/><meta name="og:url" content="https://coder.linsyorozuya.com/posts/SwiftUI%20%E5%A6%82%E4%BD%95%E7%9B%91%E5%90%AC%20@State%20%E5%8F%98%E6%9B%B4"/><title>SwiftUI å¦‚ä½•ç›‘å¬ @State å˜æ›´ | Coder ç°æ¡‘</title><meta name="twitter:title" content="SwiftUI å¦‚ä½•ç›‘å¬ @State å˜æ›´ | Coder ç°æ¡‘"/><meta name="og:title" content="SwiftUI å¦‚ä½•ç›‘å¬ @State å˜æ›´ | Coder ç°æ¡‘"/><meta name="description" content="Stay Foolish, Always Foolish"/><meta name="twitter:description" content="Stay Foolish, Always Foolish"/><meta name="og:description" content="Stay Foolish, Always Foolish"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Coder ç°æ¡‘"/></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">Coder ç°æ¡‘</a><p class="description">Stay Foolish, Always Foolish</p><nav><ul><li><a href="/">æœ€æ–°</a></li><li class="selected"><a href="/posts">Code</a></li><li><a href="/products">äº§å“</a></li><li><a href="/about">å…³äº</a></li></ul></nav></div></header><div class="wrapper"><article><h1>SwiftUI å¦‚ä½•ç›‘å¬ @State å˜æ›´</h1><div class="metadata"><ul class="tag-list"><li class="tag variant-4"><a href="/tags/swiftui">SwiftUI</a></li><li class="tag variant-2"><a href="/tags/ios">iOS</a></li></ul><span class="date">5æœˆ 8, 2021</span></div><div class="content"><h3>å‡ ç§å®ç°æ–¹å¼</h3><pre><code><span class="keyword">import</span> Combine

<span class="keyword">struct</span> ObserveStateChange: <span class="type">View</span> {
    <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
        <span class="type">VStack</span>(spacing: <span class="number">32</span>) {
            <span class="type">Solution1</span>().<span class="call">padding</span>().<span class="call">background</span>(<span class="type">Color</span>.<span class="property">red</span>)
            <span class="type">Solution2</span>().<span class="call">padding</span>().<span class="call">background</span>(<span class="type">Color</span>.<span class="property">yellow</span>)
            <span class="type">Solution3</span>().<span class="call">padding</span>().<span class="call">background</span>(<span class="type">Color</span>.<span class="property">green</span>)
        }
    }

    <span class="comment">/// 1</span>
    <span class="keyword">struct</span> Solution1: <span class="type">View</span> {
        <span class="keyword">@State var</span> location: <span class="type">String</span> = <span class="string">""</span>

        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
            <span class="keyword">let</span> binding = <span class="type">Binding</span>&lt;<span class="type">String</span>&gt;(get: {
                <span class="keyword">self</span>.<span class="property">location</span>
            }, set: {
                <span class="keyword">self</span>.<span class="property">location</span> = $0
                <span class="comment">// do whatever you want here</span>
                <span class="call">print</span>(<span class="string">"Solution1</span> \($0)<span class="string">"</span>)
            })

            <span class="type">TextField</span>(<span class="string">"Search Location"</span>, text: binding)
        }
    }

    <span class="comment">/// 2</span>
    <span class="keyword">struct</span> Solution2: <span class="type">View</span> {
        <span class="keyword">@State var</span> location: <span class="type">String</span> = <span class="string">""</span>

        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
            <span class="type">TextField</span>(<span class="string">"Search Location"</span>, text: $location)
                .<span class="call">onReceive</span>(<span class="type">Just</span>(location)) { <span class="call">print</span>(<span class="string">"Solution2</span> \($0)<span class="string">"</span>) }
        }
    }

    <span class="comment">/// 3</span>
    <span class="keyword">struct</span> Solution3: <span class="type">View</span> {
        <span class="keyword">@State var</span> location: <span class="type">String</span> = <span class="string">""</span>

        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
            <span class="type">TextField</span>(<span class="string">"Search Location"</span>, text: $location.<span class="call">onChange</span> { <span class="call">print</span>(<span class="string">"Solution3</span> \($0)<span class="string">"</span>) })
        }
    }
    
		<span class="comment">/// 4</span>
    <span class="keyword">struct</span> Solution4: <span class="type">View</span> {
        <span class="keyword">@State var</span> location: <span class="type">String</span> = <span class="string">""</span>

        <span class="keyword">var</span> body: <span class="keyword">some</span> <span class="type">View</span> {
            <span class="type">TextField</span>(<span class="string">"Search Location"</span>, text: $location)
             .<span class="call">onChange</span>(of: location) { 
                 <span class="call">print</span>(<span class="string">"Solution4</span> \($0)<span class="string">"</span>)   
            }
        }
    }
}

<span class="keyword">extension</span> <span class="type">Binding</span> {
    <span class="keyword">func</span> onChange(<span class="keyword">_</span> handler: <span class="keyword">@escaping</span> (<span class="type">Value</span>) -&gt; <span class="type">Void</span>) -&gt; <span class="type">Binding</span>&lt;<span class="type">Value</span>&gt; {
        <span class="type">Binding</span>(
            get: { <span class="keyword">self</span>.<span class="property">wrappedValue</span> },
            set: { newValue <span class="keyword">in
                self</span>.<span class="property">wrappedValue</span> = newValue
                <span class="call">handler</span>(newValue)
            }
        )
    }
}

</code></pre><p>1âƒ£ï¸ä½¿ç”¨å®šä¹‰ä¸€ä¸ª Binding å±æ€§ï¼Œé€šè¿‡ get å’Œ set æ¥å˜æ›´ @Stateã€‚</p><p>2âƒ£ï¸é€šè¿‡ onReceive ç›‘å¬ Just Publisher åŒ…è£… State ä¿ƒå‘çš„äº‹ä»¶</p><p>3âƒ£ï¸é€šè¿‡æ‹“å±• Binding æ·»åŠ ä¸€ä¸ªæ–¹æ³•å®ç°æ–¹æ³•ä¸€çš„ç±»ä¼¼å®ç°ï¼ŒåŒ…è£¹ä¸€å±‚ Binding æ¥å°†å˜æ›´å›è°ƒå‡ºå»ã€‚</p><p>4âƒ£ï¸iOS14 æ”¯æŒçš„æ–°ç‰¹æ€§ã€‚</p><p><strong>ç»è¿‡å®è·µæ¨èä½¿ç”¨3âƒ£ï¸æˆ–è€…4âƒ£ï¸ã€‚</strong></p></div></article></div><div class="item-bottom-nav"><a href="/posts/Xcode é¡¹ç›®å¤šç¯å¢ƒé…ç½®" class="item">ğŸ”™Â  Xcode é¡¹ç›®å¤šç¯å¢ƒé…ç½®</a><div class="item"><a href="/posts/SwiftUI å¼€å‘å›¾ç‰‡æ¨¡ç³Šçš„ MAC å°åº”ç”¨">SwiftUI - å¼€å‘å›¾ç‰‡æ¨¡ç³Šçš„ MAC å°åº”ç”¨  ğŸ”œ</a></div></div><footer><p>Copyright Â© 2021 ç°æ¡‘</p><p>Powered by <a href="https://github.com/johnsundell/publish">John Sundell's Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>